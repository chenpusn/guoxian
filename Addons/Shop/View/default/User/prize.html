<include file="./Addons/Shop/View/default/User/_head.html"/>
<style type="text/css">
    .mui-input-row label {
        width: 25%;
    }

    .mui-input-row label ~ input {
        width: 75%;
    }
</style>
<body>
<div class="mui-bar mui-bar-nav">
    <a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left"></a>

    <h1 class="mui-title">抽奖</h1>
</div>
<div class="mui-content" style="padding-top: 3.75rem">
    <div class="mui-content-padded" style="margin: 5px;">
        <div id="jq22">
            <div class="plate">
                <a id="plateBtn" href="javascript:" title="开始抽奖">开始抽奖</a>
            </div>

            <div class="prize">
                <h4>奖品设置</h4>
                <ul>
                    <li><strong>一等奖：</strong>iPhone 6 Plus（1名）</li>
                    <li><strong>二等奖：</strong>iPhone 6（2名）</li>
                    <li><strong>三等奖：</strong>iPad Air 2（5名）</li>
                    <li><strong>参与奖：</strong>充电宝（20名）</li>
                </ul>
            </div>

            <div id="result">
                <p id="resultTxt"></p>
                <a id="resultBtn" href="javascript:" title="关闭">关闭</a>
            </div>
        </div>
    </div>
</div>
<include file="./Addons/Shop/View/default/User/_footer.html"/>

<script type="text/javascript" src="{:ADDON_PUBLIC_PATH}/user/js/jquery.min.js"></script>
<script type="text/javascript" src="{:ADDON_PUBLIC_PATH}/user/js/mui.min.js?v={:SITE_VERSION}"></script>
<script type="text/javascript" src="{:ADDON_PUBLIC_PATH}/user/js/jquery.rotate.js?v={:SITE_VERSION}"></script>

<script type="text/javascript">
    mui.init({});
    $(function(){
        var $plateBtn = $('#plateBtn');
        var $result = $('#result');
        var $resultTxt = $('#resultTxt');
        var $resultBtn = $('#resultBtn');

        $plateBtn.click(function(){
            var data = [0, 1, 2, 3, 4, 5, 6, 7];
            data = data[Math.floor(Math.random()*data.length)];
            switch(data){
                case 1:
                    rotateFunc(1,157,'恭喜你中了 <em>一等奖</em>');
                    break;
                case 2:
                    rotateFunc(2,65,'恭喜你中了 <em>二等奖</em>');
                    break;
                case 3:
                    rotateFunc(3,335,'恭喜你中了 <em>三等奖</em>');
                    break;
                case 4:
                    rotateFunc(4,247,'恭喜你中了 <em>四等奖</em>');
                    break;
                case 5:
                    rotateFunc(5,114,'谢谢参与，请再接再厉');
                    break;
                case 6:
                    rotateFunc(6,24,'谢谢参与，请再接再厉');
                    break;
                case 7:
                    rotateFunc(7,292,'谢谢参与，请再接再厉');
                    break;
                default:
                    rotateFunc(0,203,'恭喜你中了 <em>参与奖</em>');
            }
        });

        var rotateFunc = function(awards,angle,text){  //awards:奖项，angle:奖项对应的角度
            $plateBtn.stopRotate();
            $plateBtn.rotate({
                angle: 0,
                duration: 5000,
                animateTo: angle + 1440,  //angle是图片上各奖项对应的角度，1440是让指针固定旋转4圈
                callback: function(){
                    $resultTxt.html(text);
                    $result.show();
                }
            });
        };

        $resultBtn.click(function(){
            $result.hide();
        });
    });
</script>
</body>
</html>